function XINSlotEvent(){this.eventPopup,this.eventLayer,this.popUpStyle,this.popUpStyleSize="large",this.hasButton=!0,this.lang="ZH",this.gameType="",this.gameTypeToGame="",this.callbackFunction,this.popupTxt,this.obj,this.sessionURL="",this.sessionURLPRO="https://api.xingaming.net/QueryNextSlotEvent.xml",this.sessionURLUAT="http://116.251.227.91:7745/QueryNextSlotEvent.xml",this.imgPrefix="",this.checkTimer,this.checkPeriod=6e4,this.isPopupCreated=!1,this.hasEvent=!1,this.PID,this.keepShowing=!0,this.isAPIRunning=!1,this.SC03Txt_ZH={title:"抢金币",detail:"活动即将于金拉霸老虎机内进行,请火速点击进入",enter:"进入游戏"},this.SC03Txt_TR={title:"搶金幣",detail:"活動即將於金拉霸老虎機內進行,請火速點擊進入",enter:"進入遊戲"},this.SC03Txt_EN={title:"Grab Gold Coins",detail:'The event will be held in "Gold Class", please click to enter',enter:"Enter Game"}}function createCORSRequest(method,url){var xhr=new XMLHttpRequest;return"withCredentials"in xhr?xhr.open(method,url,!0):"undefined"!=typeof XDomainRequest?(xhr=new XDomainRequest,xhr.open(method,url)):xhr=null,xhr}function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=ff(a,b,c,d,k[0],7,-680876936),d=ff(d,a,b,c,k[1],12,-389564586),c=ff(c,d,a,b,k[2],17,606105819),b=ff(b,c,d,a,k[3],22,-1044525330),a=ff(a,b,c,d,k[4],7,-176418897),d=ff(d,a,b,c,k[5],12,1200080426),c=ff(c,d,a,b,k[6],17,-1473231341),b=ff(b,c,d,a,k[7],22,-45705983),a=ff(a,b,c,d,k[8],7,1770035416),d=ff(d,a,b,c,k[9],12,-1958414417),c=ff(c,d,a,b,k[10],17,-42063),b=ff(b,c,d,a,k[11],22,-1990404162),a=ff(a,b,c,d,k[12],7,1804603682),d=ff(d,a,b,c,k[13],12,-40341101),c=ff(c,d,a,b,k[14],17,-1502002290),b=ff(b,c,d,a,k[15],22,1236535329),a=gg(a,b,c,d,k[1],5,-165796510),d=gg(d,a,b,c,k[6],9,-1069501632),c=gg(c,d,a,b,k[11],14,643717713),b=gg(b,c,d,a,k[0],20,-373897302),a=gg(a,b,c,d,k[5],5,-701558691),d=gg(d,a,b,c,k[10],9,38016083),c=gg(c,d,a,b,k[15],14,-660478335),b=gg(b,c,d,a,k[4],20,-405537848),a=gg(a,b,c,d,k[9],5,568446438),d=gg(d,a,b,c,k[14],9,-1019803690),c=gg(c,d,a,b,k[3],14,-187363961),b=gg(b,c,d,a,k[8],20,1163531501),a=gg(a,b,c,d,k[13],5,-1444681467),d=gg(d,a,b,c,k[2],9,-51403784),c=gg(c,d,a,b,k[7],14,1735328473),b=gg(b,c,d,a,k[12],20,-1926607734),a=hh(a,b,c,d,k[5],4,-378558),d=hh(d,a,b,c,k[8],11,-2022574463),c=hh(c,d,a,b,k[11],16,1839030562),b=hh(b,c,d,a,k[14],23,-35309556),a=hh(a,b,c,d,k[1],4,-1530992060),d=hh(d,a,b,c,k[4],11,1272893353),c=hh(c,d,a,b,k[7],16,-155497632),b=hh(b,c,d,a,k[10],23,-1094730640),a=hh(a,b,c,d,k[13],4,681279174),d=hh(d,a,b,c,k[0],11,-358537222),c=hh(c,d,a,b,k[3],16,-722521979),b=hh(b,c,d,a,k[6],23,76029189),a=hh(a,b,c,d,k[9],4,-640364487),d=hh(d,a,b,c,k[12],11,-421815835),c=hh(c,d,a,b,k[15],16,530742520),b=hh(b,c,d,a,k[2],23,-995338651),a=ii(a,b,c,d,k[0],6,-198630844),d=ii(d,a,b,c,k[7],10,1126891415),c=ii(c,d,a,b,k[14],15,-1416354905),b=ii(b,c,d,a,k[5],21,-57434055),a=ii(a,b,c,d,k[12],6,1700485571),d=ii(d,a,b,c,k[3],10,-1894986606),c=ii(c,d,a,b,k[10],15,-1051523),b=ii(b,c,d,a,k[1],21,-2054922799),a=ii(a,b,c,d,k[8],6,1873313359),d=ii(d,a,b,c,k[15],10,-30611744),c=ii(c,d,a,b,k[6],15,-1560198380),b=ii(b,c,d,a,k[13],21,1309151649),a=ii(a,b,c,d,k[4],6,-145523070),d=ii(d,a,b,c,k[11],10,-1120210379),c=ii(c,d,a,b,k[2],15,718787259),b=ii(b,c,d,a,k[9],21,-343485551),x[0]=add32(a,x[0]),x[1]=add32(b,x[1]),x[2]=add32(c,x[2]),x[3]=add32(d,x[3])}function cmn(q,a,b,x,s,t){return a=add32(add32(a,q),add32(x,t)),add32(a<<s|a>>>32-s,b)}function ff(a,b,c,d,x,s,t){return cmn(b&c|~b&d,a,b,x,s,t)}function gg(a,b,c,d,x,s,t){return cmn(b&d|c&~d,a,b,x,s,t)}function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}function ii(a,b,c,d,x,s,t){return cmn(c^(b|~d),a,b,x,s,t)}function md51(s){txt="";var i,n=s.length,state=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=s.length;i+=64)md5cycle(state,md5blk(s.substring(i-64,i)));s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)tail[i>>2]|=s.charCodeAt(i)<<(i%4<<3);if(tail[i>>2]|=128<<(i%4<<3),i>55)for(md5cycle(state,tail),i=0;i<16;i++)tail[i]=0;return tail[14]=8*n,md5cycle(state,tail),state}function md5blk(s){var i,md5blks=[];for(i=0;i<64;i+=4)md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return md5blks}function rhex(n){for(var s="",j=0;j<4;j++)s+=hex_chr[n>>8*j+4&15]+hex_chr[n>>8*j&15];return s}function hex(x){for(var i=0;i<x.length;i++)x[i]=rhex(x[i]);return x.join("")}function md5(s){return hex(md51(s))}function add32(a,b){return a+b&4294967295}function add32(x,y){var lsw=(65535&x)+(65535&y),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|65535&lsw}XINSlotEvent.prototype.API=function(data){switch(data.action){case"init":this.actionInit(data);break;case"changeStyle":this.changeStyle(data);break;case"hide":this.hide();break;case"show":this.show();break;case"destroy":this.destroy();break;case"resumeTimer":this.resumeTimer();break;case"stopTimer":this.stopTimer();break;case"getEventStatus":return this.hasEvent;default:console.log("XINSlotEvent API fail")}},XINSlotEvent.prototype.actionInit=function(data){return this.isAPIRunning?void console.log("API already started"):(void 0!=data.showButton&&(1==data.showButton||0==data.showButton?this.hasButton=data.showButton:console.log("Show button value error")),"small"==data.style?this.popUpStyleSize="small":"medium"==data.style?this.popUpStyleSize="medium":"large"==data.style&&(this.popUpStyleSize="large"),void 0!=data.lang&&("TR"==data.lang||"ZH"==data.lang||"EN"==data.lang?this.lang=data.lang:console.log("Lanuage Error")),void 0!=data.afterClose&&("loop"==data.afterClose?this.keepShowing=!0:"neverShow"==data.afterClose?this.keepShowing=!1:console.log("afterClose Error")),void 0==data.imgPath?void console.log("Images path Error"):(this.imgPrefix=data.imgPath,void 0==data.pid?void console.log("PID Error"):(this.PID=data.pid,void 0==data.goGameCallback?void console.log("Callback Error"):(this.callbackFunction=data.goGameCallback,void 0==data.mode?void console.log("Mode Error"):("test"==data.mode?this.sessionURL=this.sessionURLUAT:"production"==data.mode&&(this.sessionURL=this.sessionURLPRO),this.isAPIRunning=!0,void this.checkEventTime())))))},XINSlotEvent.prototype.changeStyle=function(data){return this.isAPIRunning?(this.destroy(),void 0!=data.showButton&&(1==data.showButton||0==data.showButton?this.hasButton=data.showButton:console.log("Show button value error")),"small"==data.style?this.popUpStyleSize="small":"medium"==data.style?this.popUpStyleSize="medium":"large"==data.style&&(this.popUpStyleSize="large"),void 0!=data.lang&&("TR"==data.lang||"ZH"==data.lang||"EN"==data.lang?this.lang=data.lang:console.log("Language Error")),this.isAPIRunning=!0,void this.checkEventTime()):void console.log("API not yet start")},XINSlotEvent.prototype.GetLicenseKey=function(){return"123"},XINSlotEvent.prototype.checkEventTime=function(){this.checkTimer=setTimeout(this.resetTimer.bind(this),this.checkPeriod);var URL=(md5(this.PID+this.GetLicenseKey()),this.sessionURL+"?productid="+this.PID),xhr=createCORSRequest("GET",URL);if(!xhr)throw new Error("CORS not supported");var _this=this;xhr.onload=function(){var responseText=xhr.responseText;_this.onLoadXMLComplete(responseText)},xhr.onerror=function(){console.log("There was an error!")},xhr.send()},XINSlotEvent.prototype.resetTimer=function(){clearTimeout(this.checkTimer),this.checkEventTime(),console.log("reset timer")},XINSlotEvent.prototype.onLoadXMLComplete=function(xmlDoc){var event=xmlDoc.match(/<Next>(.*)<\/Next>/),gametype=xmlDoc.match(/<Gametype>(.*)<\/Gametype>/);xmlDoc.match(/<Countdown>(.*)<\/Countdown>/);return"false"==event[1]?(this.hasEvent=!1,console.log("No event"),void this.hide()):void("true"==event[1]?(this.hasEvent=!0,this.eventStart(gametype[1]),console.log("Event start soon!")):console.log("XML <Next> value error"))},XINSlotEvent.prototype.eventStart=function(gametype){void 0!=gametype&&(this.gameType=gametype),"SC03"==this.gameType&&(this.gameTypeToGame="802"),this.updateLang(this.lang),this.createUI()},XINSlotEvent.prototype.createUI=function(){this.isPopupCreated||(this.create(),this.addEventListener()),this.show()},XINSlotEvent.prototype.updateLang=function(lang){"SC03"==this.gameType&&("ZH"==lang?this.popupTxt=this.SC03Txt_ZH:"TR"==lang?this.popupTxt=this.SC03Txt_TR:"EN"==lang&&(this.popupTxt=this.SC03Txt_EN))},XINSlotEvent.prototype.create=function(){this.eventLayer=document.createElement("div"),this.eventLayer.className="eventLayerXINSlotEvent "+this.popUpStyleSize,this.eventLayer.id="eventLayerXINSlotEvent",document.body.appendChild(this.eventLayer),this.eventPopup=document.createElement("div"),this.eventPopup.className="eventPopupXINSlotEvent "+this.popUpStyleSize,this.eventPopup.id="eventPopupXINSlotEvent",document.body.appendChild(this.eventPopup),this.closeBtn=document.createElement("div"),this.closeBtn.className="closeBtnXINSlotEvent "+this.popUpStyleSize,this.closeBtn.id="closeBtnXINSlotEvent",document.body.appendChild(this.closeBtn),this.setStyle(this.popUpStyleSize),this.isPopupCreated=!0},XINSlotEvent.prototype.addEventListener=function(){document.getElementById("eventPopupXINSlotEvent").addEventListener("click",function(){this.onClickEventPopup()}.bind(this)),document.getElementById("closeBtnXINSlotEvent").addEventListener("click",function(){this.onClickCloseBtn()}.bind(this))},XINSlotEvent.prototype.onClickEventPopup=function(){console.log("onclick event pop up"),this.callbackFunction(this.gameTypeToGame),this.hide()},XINSlotEvent.prototype.onClickCloseBtn=function(){console.log("onclick Close","this.keepShowing::",this.keepShowing),this.keepShowing?this.hide():this.destroy()},XINSlotEvent.prototype.setStyle=function(size){if("medium"==size){this.closeBtn.style.background="url("+this.imgPrefix+this.gameType+"_CloseBtn_2.png) no-repeat";var logoDiv=document.createElement("div");logoDiv.id="logoDivXINSlotEvent",this.eventPopup.appendChild(logoDiv);var detail=document.createElement("div");detail.id="eventDetailDivXINSlotEvent",this.eventPopup.appendChild(detail);var iconDiv=document.createElement("div");iconDiv.id="iconDivXINSlotEvent",detail.appendChild(iconDiv);var txtDiv=document.createElement("div");txtDiv.id="txtDivXINSlotEvent",detail.appendChild(txtDiv);var txtDetail=document.createElement("div");txtDetail.id="txtDetailXINSlotEvent",txtDiv.appendChild(txtDetail);var txtDetailTitle=document.createElement("div");txtDetailTitle.id="txtDetailTitleXINSlotEvent",txtDetail.appendChild(txtDetailTitle);var txtDetailContent=document.createElement("div");if(txtDetailContent.id="txtDetailContentXINSlotEvent",txtDetail.appendChild(txtDetailContent),this.hasButton){var txtButton=document.createElement("div");txtButton.id="txtButtonXINSlotEvent",txtDiv.appendChild(txtButton);var txtButtonLabel=document.createElement("h1");txtButtonLabel.id="txtButtonLabelXINSlotEvent",txtButton.appendChild(txtButtonLabel),txtButtonLabel.innerHTML=this.popupTxt.enter}logoDiv.innerHTML='<img src="'+this.imgPrefix+'xin_logo.png")/>',iconDiv.innerHTML='<img src="'+this.imgPrefix+this.gameType+"_BG_"+this.lang+'_2.png")/>',txtDetailTitle.innerHTML=this.popupTxt.title,txtDetailContent.innerHTML=this.popupTxt.detail}else"small"==size?(this.hasButton?this.eventPopup.style.background="url("+this.imgPrefix+this.gameType+"_BG_"+this.lang+"_3_1.jpg) no-repeat":this.eventPopup.style.background="url("+this.imgPrefix+this.gameType+"_BG_"+this.lang+"_3_2.jpg) no-repeat",this.closeBtn.style.background="url("+this.imgPrefix+this.gameType+"_CloseBtn_1.png) no-repeat"):"large"==size&&(this.hasButton?this.eventPopup.style.background="url("+this.imgPrefix+this.gameType+"_BG_"+this.lang+"_1_1.png) no-repeat":this.eventPopup.style.background="url("+this.imgPrefix+this.gameType+"_BG_"+this.lang+"_1_2.png) no-repeat",this.closeBtn.style.background="url("+this.imgPrefix+this.gameType+"_CloseBtn_1.png) no-repeat")},XINSlotEvent.prototype.actionUpdate=function(){},XINSlotEvent.prototype.resumeTimer=function(){return this.isAPIRunning?void this.resetTimer():void console.log("API not yet start")},XINSlotEvent.prototype.stopTimer=function(){return this.isAPIRunning?void clearTimeout(this.checkTimer):void console.log("API not yet start")},XINSlotEvent.prototype.hide=function(){this.eventPopup&&(this.eventPopup.style.display="none"),this.closeBtn&&(this.closeBtn.style.display="none"),this.eventLayer&&(this.eventLayer.style.display="none")},XINSlotEvent.prototype.show=function(){return this.isAPIRunning?(this.eventPopup&&(this.eventPopup.style.display="block"),this.closeBtn&&(this.closeBtn.style.display="block"),void(this.eventLayer&&(this.eventLayer.style.display="block"))):void console.log("API not yet start")},XINSlotEvent.prototype.destroy=function(){return this.isAPIRunning?(this.eventPopup&&document.body.removeChild(this.eventPopup),this.closeBtn&&document.body.removeChild(this.closeBtn),this.eventLayer&&document.body.removeChild(this.eventLayer),this.stopTimer(),this.isAPIRunning=!1,void(this.isPopupCreated=!1)):void console.log("API not yet start")};var hex_chr="0123456789abcdef".split("");"5d41402abc4b2a76b9719d911017c592"!=md5("hello");

if (typeof module !== 'undefined' && typeof exports === 'object') {
    module.exports = XINSlotEvent;
}else {
    window.XINSlotEvent = XINSlotEvent;
}